(window.webpackJsonp=window.webpackJsonp||[]).push([[269],{919:function(t,a,s){"use strict";s.r(a);var n=s(12),e=Object(n.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h2",{attrs:{id:"作用"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#作用"}},[t._v("#")]),t._v(" 作用")]),t._v(" "),s("p",[t._v("离线缓存")]),t._v(" "),s("p",[t._v("注意与 "),s("code",[t._v('<link rel="manifest" href="./manifest.webmanifest">')]),t._v(" 中的 manifest 并不是一个东西。")]),t._v(" "),s("h2",{attrs:{id:"已停止支持"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#已停止支持"}},[t._v("#")]),t._v(" 已停止支持")]),t._v(" "),s("p",[t._v("chrome 在 2020 年 8 月删除了这个特性。")]),t._v(" "),s("h2",{attrs:{id:"弊端"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#弊端"}},[t._v("#")]),t._v(" 弊端")]),t._v(" "),s("ol",[s("li",[s("p",[t._v("一旦你采用了 manifest 之后，你将不能清空这些缓存，只能更新缓存，或者得用户自己去清空这些缓存。一旦缓存了错误的文件修复成本较大。")])]),t._v(" "),s("li",[s("p",[t._v("使用 manifest 需要严格按照它规定的语法，需要注意换行和路径文件名等问题。")])]),t._v(" "),s("li",[s("p",[t._v("如果更新的资源中有一个资源更新失败了，将导致全部更新失败，将用回上一版本的缓存。")])]),t._v(" "),s("li",[s("p",[t._v("二次更新的问题，即在更新新版本过程中，用户需要第一次时访问的还是旧的资源，需要第二次进去才是新的资源。如果此时后台接口发生变化，访问第一次时的旧数据很可能将出现兼容问题。")])]),t._v(" "),s("li",[s("p",[t._v("限制大小问题，一般是最多缓存 5mb，不过一般是够用的。")])]),t._v(" "),s("li",[s("p",[t._v("回滚问题，这个可以参考之前的一篇《慎用 manifest》的文章，大体是从无到有，又想回滚到无的情形。")])])]),t._v(" "),s("h2",{attrs:{id:"使用方法"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#使用方法"}},[t._v("#")]),t._v(" 使用方法")]),t._v(" "),s("ul",[s("li",[t._v("html 中指定缓存配置文件")])]),t._v(" "),s("p",[t._v("在 html 标签上用 manifest 属性指定缓存配置文件")]),t._v(" "),s("div",{staticClass:"language-html extra-class"},[s("pre",{pre:!0,attrs:{class:"language-html"}},[s("code",[s("span",{pre:!0,attrs:{class:"token doctype"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<!")]),s("span",{pre:!0,attrs:{class:"token doctype-tag"}},[t._v("DOCTYPE")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token name"}},[t._v("html")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("html")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("manifest")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("test.manifest"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("html")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),s("ul",[s("li",[t._v("配置文件")])]),t._v(" "),s("p",[t._v("CACHE MANIFEST -文件申明\nCACHE- 需要缓存的文件。需要相对路径\nNETWORK - 在此标题下列出的文件需要与服务器的连接，且不会被缓存\nFALLBACK - 在此标题下列出的文件规定当页面无法访问时的回退页面（比如 404 页面）")]),t._v(" "),s("div",{staticClass:"language-conf extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("CACHE MANIFEST    //文件声明\n# 2012-02-21 v1.0.0     //#号后面是注释\n\nCACHE            //要缓存的文件。需要相对路径\n/theme.css\n/logo.gif\n/main.js\n\nNETWORK:         //不缓存的文件。需要与服务器连接时才读取\nlogin.asp         //如果 NETWORK 下面使用 *,表示所有其他文件需要连接服务器读取，不缓存\n\nFALLBACK:        //无法访问时的回退页面\n#当html5这个文件夹文件无法访问时，都使用 404 页面\n/html5/ /404.html\n#当无法访问index这个文件时，都使用 404 页面\n/index.js  /404.html\n")])])]),s("h3",{attrs:{id:"更新缓存"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#更新缓存"}},[t._v("#")]),t._v(" 更新缓存")]),t._v(" "),s("ol",[s("li",[s("p",[t._v("修改 manifest 文件，修改备注也会触发更新缓存。")])]),t._v(" "),s("li",[s("p",[t._v("通过 js 清除缓存，window.applicationCache.update()。")])]),t._v(" "),s("li",[s("p",[t._v("清除浏览器缓存。")])])]),t._v(" "),s("h2",{attrs:{id:"其他"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#其他"}},[t._v("#")]),t._v(" 其他")]),t._v(" "),s("ol",[s("li",[t._v("站点离线存储的容量限制是 5M")]),t._v(" "),s("li",[t._v("如果 manifest 文件，或者内部列举的某一个文件不能正常下载，整个更新过程将视为失败，浏览器继续全部使用老的缓存")]),t._v(" "),s("li",[t._v("引用 manifest 的 html 必须与 manifest 文件同源，在同一个域下")]),t._v(" "),s("li",[t._v("在 manifest 中使用的相对路径，相对参照物为 manifest 文件")]),t._v(" "),s("li",[t._v("CACHE MANIFEST 字符串应在第一行，且必不可少")]),t._v(" "),s("li",[t._v("系统会自动缓存引用清单文件的 HTML 文件")]),t._v(" "),s("li",[t._v("manifest 文件中 CACHE 则与 NETWORK，FALLBACK 的位置顺序没有关系，如果是隐式声明需要在最前面")]),t._v(" "),s("li",[t._v("FALLBACK 中的资源必须和 manifest 文件同源")]),t._v(" "),s("li",[t._v("当一个资源被缓存后，该浏览器直接请求这个绝对路径也会访问缓存中的资源。")]),t._v(" "),s("li",[t._v("站点中的其他页面即使没有设置 manifest 属性，请求的资源如果在缓存中也从缓存中访问")]),t._v(" "),s("li",[t._v("当 manifest 文件发生改变时，资源请求本身也会触发更新")])])])}),[],!1,null,null,null);a.default=e.exports}}]);