---
date: 2021-09-09 14:42:36
title: HTTPS 协议
tags:
  - myGit
  - learning-Notes
  - document
  - technology
  - 网络
  - http协议
---

`HTTP + 加密 + 认证 + 完整性保护 = HTTPS（HTTP Secure ）`

HTTP 协议中没有加密机制,但可以通 过和 SSL(Secure Socket Layer, 安全套接层 )或 TLS(Transport Layer Security, 安全层传输协议)的组合使用,加密 HTTP 的通信内容。属于通信加密，即在整个通信线路中加密。

## HTTPS 握手过程

1.  浏览器将自己支持的一套加密规则发送给网站——服务器获得浏览器公钥。
2.  网站从中选出一组加密算法与 HASH 算法，并将自己的身份信息以证书的形式发回给浏览器。证书里面包含了网站地址，加密公钥，以及证书的颁发机构等信息——浏览器获得服务器公钥。
3.  获得网站证书之后浏览器要做以下工作：
    `浏览器验证 -> 随机密码 服务器的公钥加密 -> 通信的密钥 通信的密钥 -> 服务器`

        1. 验证证书的合法性（颁发证书的机构是否合法，证书中包含的网站地址是否与正在访问的地址一致等），如果证书受信任，则浏览器栏里面会显示一个小锁头，否则会给出证书不受信的提示。
        2. 如果证书受信任，或者是用户接受了不受信的证书，浏览器会生成一串随机数的密码（接下来通信的密钥），并用证书中提供的公钥加密（共享密钥加密）。
        3. 使用约定好的HASH计算握手消息，并使用生成的随机数对消息进行加密，最后将之前生成的所有信息发送给网站。

4.  网站接收浏览器发来的数据之后要做以下的操作：
    `服务器用自己的私钥解出随机密码 -> 用密码解密握手消息（共享密钥通信）-> 验证HASH与浏览器是否一致（验证浏览器）`

        1. 使用自己的私钥将信息解密取出密码，使用密码解密浏览器发来的握手消息，并验证HASH是否与浏览器发来的一致。
        2. 使用密码加密一段握手消息，发送给浏览器。

## HTTPS 协议的不足

1. 加密解密过程复杂，导致访问速度慢
2. 加密需要认向证机构付费
3. 整个页面的请求都要使用 HTTPS

## 参考

[深入理解 HTTP 协议](https://zhuanlan.zhihu.com/p/45173862)
